/*! touch 2016-11-04 */
define(function(){return function(a,b){$("#container").load(a,function(){var a=b.orderId;Pay.getPayDetail({order_id:a},function(b){function c(){var a={};a.title="请在新打开的页面上完成付款",a.width=600,a.content=$("#payWarnTemplate").tmpl({});$.alertPop(a,function(){$(".pay_btn .change").on("click",function(){$.closePop()}),$(".pay_btn .cancel").on("click",function(){$.goPage("#mycenter/myorder"),$.closePop()})})}if(console.log(b),200==b.code){$("#order_pay").html($("#payDetailTemplate").tmpl(b.data)),1!=b.data.has_material&&$(".pingtaibi").show();var d=b.data.intval;if(d>1)var e=setInterval(function(){if(-1!=location.hash.indexOf("pay")){var b=$.timeFormat(d);$(".order_succ_bh span").html(b),d--,1>=d&&(Order.invalidByOid({order_id:a},function(a){200==a.code?location.reload():$.alertTmpMsg(a.message)}),clearInterval(e))}else clearInterval(e)},1e3);else $(".zhifu").hide()}else $.alertTmpMsg(b.message);$(".payment_list").on("click",function(){$(this).hasClass("active")||($(".payment_list.active").removeClass("active"),$(this).addClass("active")),5==$(this).data("type")?$(".order_bank").show():$(".order_bank").hide()}),$(".bank_list").on("click",function(){$(this).hasClass("active")?$(this).removeClass("active"):($(".bank_list.active").removeClass("active"),$(this).addClass("active"))}),window.paynow=function(){$.get("front.php?s=/Home/Stat/stat",{type:"pay_btn"});var b,d=$(".payment_list.active").data("type");if(1==d)b="/front.php?s=/Home/Checkout/submit&order_id="+a,window.open(b),c();else if(3==d)b="#weixin/"+a,window.open(b),c();else if(4==d)Game.payConins({order_id:a},function(b){if(200==b.code)$.alertTmpMsg("购买成功"),setTimeout(function(){$.goPage("#success/"+a)},1e3);else if(500120==b.code){var c={};c.content=$("#ptbczPop").tmpl({}),c.width=450,$.alertPop(c,function(){$(".pop_cancel").on("click",function(){$.closePop()}),$(".pop_ok").on("click",function(){$.closePop(),window.location.href=Links.recharge+"?redirect="+encodeURIComponent(location.href)+"&broker=fuzemall&l=zh-cn"})})}else $.alertTmpMsg(b.message)});else if(5==d){var e=$(".bank_list.active").data("type");"undefined"==typeof e&&(e=""),b="/front.php?s=/Home/Checkout/unionpay&order_id="+a+"&issInsCode="+e,window.open(b),c()}}}),$(".order_info .selectBox").on("click",function(){$(".order_info .selectBox.active").removeClass("active"),$(this).addClass("active")})})}});