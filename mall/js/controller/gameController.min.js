/*! touch 2016-11-04 */
define(function(){return function(a,b){$("#container").loadPage(a,["css/slide.css","css/pagination.css","css/game.css"],function(){function a(a,b,c,d){$(".gamelist_loading").show(),$(".look_all").hide(),Game.getGameList({type:a,page:b,pagesize:c},function(a){if($(".gamelist_loading").hide(),$(".look_all").show(),a.code=200){(a.data.list.length<20||a.data.totalNum<=20)&&$(".look_all").hide(),d?$(".game-list").html($("#gameList").tmpl({list:a.data.list})):$("#gameList").tmpl({list:a.data.list}).appendTo($(".game-list")),$.fn.extend({displayPart:function(){var a=70;a=this.attr("displayLength")||a;var b=this.text();if(!b)return"";for(var c="",d=0,e=0;a>e;e++){var f=b.charAt(e);if(d>=a)break;/[^x00-xff]/.test(f)&&d++,c+=f,d++}c.length<b.length&&(c+="..."),this.text(c)}});for(var b=$(".displayPart"),c=0;c<b.length;c++)$(b[c]).displayPart()}else $.alertTmpMsg(a.message)})}function b(){$(".keyword").hide(),$(".search input[type='text']").val(""),a("0","1","20",!0)}Goods.getBanner({pid:3},function(a){200==a.code&&($(".game-banner-list").html($("#game-banner-tem").tmpl(a.data)),$(".game-txt").show(),$(".game-groups").show(),$(".look_all").show(),setTimeout(function(){$(".game-banner").bannerSlider({ul:".game-banner-list",ulTips:".game-banner-tip-list",moveWay:"roll"})},100))}),Game.getGameCate("",function(a){200==a.code&&($(".game-groups").show(),$(".kindul").html($("#gameCate").tmpl({list:a.list})))}),$(".kindul").on("click","li",function(){$(".txt").val(""),$(".keyword").hide();var a=($(this).index(),$(this).find("a").attr("id"));$(".look_all").attr("cid",a),$(".look_all").attr("data-page","1"),$(".look_all").hide(),$(this).find("a").addClass("hover_bg").parent("li").siblings().find("a").removeClass("hover_bg"),Game.getGameList({type:a,page:"1",pagesize:"20"},function(a){if(200==a.code){$(".game-list").html($("#gameList").tmpl({list:a.data.list})),$(".look_all").show(),(a.data.list.length<20||a.data.totalNum<=20)&&$(".look_all").hide(),$.fn.extend({displayPart:function(){var a=70;a=this.attr("displayLength")||a;var b=this.text();if(!b)return"";for(var c="",d=0,e=0;a>e;e++){var f=b.charAt(e);if(d>=a)break;/[^x00-xff]/.test(f)&&d++,c+=f,d++}c.length<b.length&&(c+="..."),this.text(c)}});for(var b=$(".displayPart"),c=0;c<b.length;c++)$(b[c]).displayPart()}})}),$(".look_all").on("click",function(){var b=$(this).attr("data-page"),c=$(this).attr("cid");b++,$(this).attr("data-page",b),c?a(c,b,"20"):a("",b,"20")}),$(document).keydown(function(a){var a=event.event||window.event;13==a.keyCode&&$(".search button").trigger("click")}),$(".search button").on("click",function(){$(".kindul li").find("a").removeClass("hover_bg"),$(".kindul li").eq(0).find("a").addClass("hover_bg");var a=$.trim($(".search input[type='text']").val());""!=a&&($(".keyword").show().find("span").text('"'+a+'"'),$(".game-list").addClass("loading").html(""),Goods.gameSearch({keyword:a},function(b){if($(".look_all").hide(),$(".gamelist_loading").hide(),200==b.code){$(".look_all").hide(),b.data.list&&b.data.list.length>0?$(".game-list").html($("#gameList").tmpl({list:b.data.list})):$(".game-list").html('<div class="empty_list">抱歉，没有找到“<span style="color:#23aeb3;">'+a+"</span>”的搜索结果。</div>"),$.fn.extend({displayPart:function(){var a=70;a=this.attr("displayLength")||a;var b=this.text();if(!b)return"";for(var c="",d=0,e=0;a>e;e++){var f=b.charAt(e);if(d>=a)break;/[^x00-xff]/.test(f)&&d++,c+=f,d++}c.length<b.length&&(c+="..."),this.text(c)}});for(var c=$(".displayPart"),d=0;d<c.length;d++)$(c[d]).displayPart()}else $.alertTmpMsg(b.message)}))}),$(".keyword a").on("click",function(){b()}),$(".game-list").on("click",".game-intro",function(){window.open("#gameItem/"+$(this).attr("id"))}),search_keyword?($(".search input[type='text']").val(search_keyword),search_keyword="",$(".search a").trigger("click")):a("",1,20)})}});